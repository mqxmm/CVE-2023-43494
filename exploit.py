import requests
import re

def check_jenkins_cve(base_url, project_name, search_string):
    url = f"{base_url}/job/{project_name}/buildHistory/ajax?search={search_string}"
    headers = {
        "accept": "*/*",
        "accept-language": "en-US,en;q=0.9",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "referer": f"{base_url}/job/{project_name}/",
        "referrerPolicy": "same-origin"
    }

    try:
        response = requests.get(url, headers=headers, timeout=10)

        if response.status_code == 200:
            print(f"[+] HTTP Status 200 received for {url}")

            regex_pattern = r"(?s)<table[^>]*>.*?<tr[^>]*>.*?</tr>.*?</table>"
            if re.search(regex_pattern, response.text):
                print(f"[+] Potentially vulnerable: Found matching table structure in response.")
            else:
                print("[-] No matching table structure found in the response.")
        else:
            print(f"[-] Unexpected HTTP status: {response.status_code}")

    except requests.exceptions.RequestException as e:
        print(f"[!] Error occurred: {e}")

base_url = "http://jenkinssite.com"
project_name = "my_project"
search_string = "password"

check_jenkins_cve(base_url, project_name, search_string)
